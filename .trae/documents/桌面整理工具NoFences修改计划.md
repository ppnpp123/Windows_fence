# 桌面整理工具NoFences修改计划

## 1. 完善屏幕缩放下的高清显示

### 问题分析
当前应用在不同DPI设置下可能显示模糊，需要确保所有UI元素都能根据系统DPI进行正确缩放。

### 修改点
- **FenceWindow.cs**：确保所有绘图操作使用DPI缩放
  - 检查并修改`itemWidth`、`itemHeight`、`textHeight`等常量的处理方式
  - 确保字体大小、图标大小和间距都根据DPI进行缩放
  - 修改绘图代码，使用`Graphics.DpiX`和`Graphics.DpiY`属性进行缩放计算
  - 确保鼠标事件处理也考虑DPI缩放

- **Win32/DesktopUtil.cs**：检查桌面相关操作的DPI处理

## 2. 实现图标拖动复制快捷方式功能

### 问题分析
当前应用将拖动的文件直接添加到栅栏中，使用的是原始文件路径。需要修改为创建快捷方式并保存到独立文件夹。

### 修改点
- **FenceWindow.cs**：
  - 修改`FenceWindow_DragDrop`方法，实现快捷方式创建逻辑
  - 添加创建和管理独立文件夹的功能
  - 确保拖动的文件类型支持创建快捷方式

- **Model/FenceInfo.cs**：
  - 可能需要添加字段来存储快捷方式的原始路径（如果需要）

- **Util/Extensions.cs**：
  - 添加创建快捷方式的辅助方法

## 3. 打包应用为exe

### 问题分析
当前项目是C# WinForms应用，需要确保可以生成独立的exe文件，方便用户直接运行。

### 修改点
- 检查项目属性中的生成设置
- 确保所有依赖项都能正确打包
- 考虑使用ClickOnce或其他打包工具生成安装程序

## 实施步骤

1. 首先修改DPI缩放相关代码，确保应用在各种屏幕缩放下都能高清显示
2. 然后实现图标拖动复制快捷方式功能
3. 最后配置项目打包设置，生成独立的exe文件

## 预期效果

1. 应用在任何屏幕缩放比例下都能清晰显示
2. 拖动图标到栅栏中时，会自动创建快捷方式并保存到独立文件夹
3. 生成的exe文件可以直接运行，无需额外依赖